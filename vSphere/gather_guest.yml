- hosts: localhost
  tasks:
  - name: Gather all registered virtual machines
    delegate_to: localhost
    vmware_guest_facts:
      hostname: "{{ ansible_env.VMWARE_HOST }}"
      username: "{{ ansible_env.VMWARE_USER }}"
      password: "{{ ansible_env.VMWARE_PASSWORD }}"
      datacenter: ha-datacenter
      validate_certs: no
    register: vmfacts
  ##with_items:
    ##- {esxi_hostname: hostname_1, esxi_user: username_host_1, esxi_pass: pass_host_1}
    ##- {esxi_hostname: hostname_2, esxi_user: username_host_2, esxi_pass: pass_host_2}
  - debug:
      var: vmfacts